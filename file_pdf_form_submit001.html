<script>
document.addEventListener("DOMContentLoaded", function () {
    const pdfForm = document.querySelector('form[action*="run-module"]');
    if (!pdfForm) return;

    pdfForm.addEventListener("submit", function (e) {
        e.preventDefault();

        const formData = new FormData(pdfForm);
        const url = pdfForm.action;

        fetch(url, {
            method: "POST",
            headers: {
                "X-Requested-With": "XMLHttpRequest",
                "X-CSRFToken": formData.get("csrfmiddlewaretoken")
            },
            body: formData
        })
        .then(response => response.text())
        .then(data => {
            document.getElementById("ajaxresponse").innerHTML = data;
        })
        .catch(error => {
            document.getElementById("ajaxresponse").innerHTML = `<p class="text-danger">Error: ${error}</p>`;
        });
    });
});
</script>
